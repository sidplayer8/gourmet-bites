<!DOCTYPE html>
<html>

<head>
    <title>Menu - Gourmet Bites</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="menu-page">
        <div class="menu-header">
            <h1>Menu</h1>
            <div class="header-actions">
                <a href="profile.html" class="btn-profile">
                    <img id="profilePic" src="" alt="Profile" class="profile-pic">
                    <span id="userName">Profile</span>
                </a>
                <button class="btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="category-nav"
            style="position:sticky; top:0; background:#1a1a2e; z-index:100; padding:10px 20px; overflow-x:auto; white-space:nowrap; border-bottom:1px solid #333; margin-bottom:20px;">
            <button class="cat-btn active" onclick="filterMenu('All')"
                style="background:none; border:none; color:white; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer; font-weight:bold;">All</button>
            <button class="cat-btn" onclick="filterMenu('Burgers')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Burgers</button>
            <button class="cat-btn" onclick="filterMenu('Pizza')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Pizza</button>
            <button class="cat-btn" onclick="filterMenu('Mains')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Mains</button>
            <button class="cat-btn" onclick="filterMenu('Salads')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Salads</button>
            <button class="cat-btn" onclick="filterMenu('Appetizers')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Sides</button>
            <button class="cat-btn" onclick="filterMenu('Drinks')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Drinks</button>
            <button class="cat-btn" onclick="filterMenu('Dessert')"
                style="background:none; border:none; color:#999; padding:8px 16px; margin-right:8px; border-radius:20px; cursor:pointer;">Dessert</button>
        </div>

        <div id="menuView" class="menu-grid"></div>

        <div id="cartView" class="cart-page" style="display:none;">
            <h2>Your Cart</h2>
            <div id="cartItems"></div>
            <div class="cart-total">
                <h3>Total: <span id="cartTotal">$0.00</span></h3>
                <button class="btn-checkout" onclick="checkout()">Place Order</button>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn active" onclick="showView('menu')">
                <span>🍽️</span>
                <span>Menu</span>
            </button>
            <button class="nav-btn" onclick="showView('cart')">
                <span style="position:relative;">
                    🛒
                    <span class="cart-badge"
                        style="position:absolute; top:-8px; right:-12px; background:#ff6600; color:white; border-radius:50%; width:20px; height:20px; font-size:11px; display:flex; align-items:center; justify-content:center; font-weight:bold;">0</span>
                </span>
                <span>Cart</span>
            </button>
        </div>
    </div>

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Supabase inline config -->
    <script src="supabase-inline.js"></script>

    <!-- App logic -->
    <script src="app.js"></script>

    <script>
        // Load menu when page loads
        window.addEventListener('DOMContentLoaded', () => {
            if (typeof loadMenu === 'function') {
                loadMenu();
            }
        });

        // Set profile picture and name
        const user = JSON.parse(localStorage.getItem('user'));
        if (user) {
            const profilePic = document.getElementById('profilePic');
            const userName = document.getElementById('userName');

            // Construct fallback URL based on name or phone
            const displayName = user.name || user.phone || 'User';
            const fallbackUrl = 'https://ui-avatars.com/api/?name=' + encodeURIComponent(displayName) + '&background=ff6600&color=fff&size=128';

            profilePic.onerror = function () {
                this.onerror = null;
                this.src = fallbackUrl;
            };

            if (user.photoURL && user.photoURL.trim() !== '') {
                profilePic.src = user.photoURL;
            } else {
                profilePic.src = fallbackUrl;
            }

            userName.textContent = displayName;
        }
    </script>
</body>

</html>